public abstract class org.waveprotocol.box.server.rpc.AbstractSearchServlet extends javax.servlet.http.HttpServlet
{
    private static final org.waveprotocol.wave.util.logging.Log LOG;
    private static java.lang.String DEFAULT_QUERY;
    private static java.lang.String DEFAULT_NUMRESULTS;
    protected final org.waveprotocol.box.server.robots.util.ConversationUtil conversationUtil;
    protected final com.google.wave.api.data.converter.EventDataConverterManager converterManager;
    protected final org.waveprotocol.box.server.waveserver.WaveletProvider waveletProvider;
    protected final org.waveprotocol.box.server.authentication.SessionManager sessionManager;
    protected final org.waveprotocol.box.server.robots.OperationServiceRegistry operationRegistry;

    private static java.lang.String getParameter(javax.servlet.http.HttpServletRequest, java.lang.String, java.lang.String)
    {
        javax.servlet.http.HttpServletRequest r0;
        java.lang.String r1, $r2, r3, $r4;

        r0 := @parameter0: javax.servlet.http.HttpServletRequest;

        r1 := @parameter1: java.lang.String;

        r3 := @parameter2: java.lang.String;

        $r2 = interfaceinvoke r0.<javax.servlet.http.HttpServletRequest: java.lang.String getParameter(java.lang.String)>(r1);

        if $r2 != null goto label1;

        $r4 = r3;

        goto label2;

     label1:
        $r4 = $r2;

     label2:
        return $r4;
    }

    public void <init>(org.waveprotocol.box.server.robots.util.ConversationUtil, com.google.wave.api.data.converter.EventDataConverterManager, org.waveprotocol.box.server.waveserver.WaveletProvider, org.waveprotocol.box.server.authentication.SessionManager, org.waveprotocol.box.server.robots.OperationServiceRegistry)
    {
        org.waveprotocol.box.server.authentication.SessionManager r4;
        org.waveprotocol.box.server.robots.util.ConversationUtil r1;
        com.google.wave.api.data.converter.EventDataConverterManager r2;
        org.waveprotocol.box.server.waveserver.WaveletProvider r3;
        org.waveprotocol.box.server.rpc.AbstractSearchServlet r0;
        org.waveprotocol.box.server.robots.OperationServiceRegistry r5;

        r0 := @this: org.waveprotocol.box.server.rpc.AbstractSearchServlet;

        r1 := @parameter0: org.waveprotocol.box.server.robots.util.ConversationUtil;

        r2 := @parameter1: com.google.wave.api.data.converter.EventDataConverterManager;

        r3 := @parameter2: org.waveprotocol.box.server.waveserver.WaveletProvider;

        r4 := @parameter3: org.waveprotocol.box.server.authentication.SessionManager;

        r5 := @parameter4: org.waveprotocol.box.server.robots.OperationServiceRegistry;

        specialinvoke r0.<javax.servlet.http.HttpServlet: void <init>()>();

        r0.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.robots.util.ConversationUtil conversationUtil> = r1;

        r0.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: com.google.wave.api.data.converter.EventDataConverterManager converterManager> = r2;

        r0.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.waveserver.WaveletProvider waveletProvider> = r3;

        r0.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.authentication.SessionManager sessionManager> = r4;

        r0.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.robots.OperationServiceRegistry operationRegistry> = r5;

        return;
    }

    public static org.waveprotocol.box.search.SearchProto$SearchRequest parseSearchRequest(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)
    {
        org.waveprotocol.box.search.SearchProto$SearchRequest$Builder $r6, $r7, $r8, $r9;
        javax.servlet.http.HttpServletResponse r11;
        org.waveprotocol.box.search.SearchProto$SearchRequest $r10;
        javax.servlet.http.HttpServletRequest r0;
        int $i0, $i1;
        java.lang.String $r1, $r2, $r3, $r4, $r5;

        r0 := @parameter0: javax.servlet.http.HttpServletRequest;

        r11 := @parameter1: javax.servlet.http.HttpServletResponse;

        $r1 = <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String DEFAULT_QUERY>;

        $r2 = staticinvoke <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String getParameter(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)>(r0, "query", $r1);

        $r3 = staticinvoke <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String getParameter(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)>(r0, "index", "0");

        $r4 = <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String DEFAULT_NUMRESULTS>;

        $r5 = staticinvoke <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String getParameter(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)>(r0, "numResults", $r4);

        $r6 = staticinvoke <org.waveprotocol.box.search.SearchProto$SearchRequest: org.waveprotocol.box.search.SearchProto$SearchRequest$Builder newBuilder()>();

        $r7 = virtualinvoke $r6.<org.waveprotocol.box.search.SearchProto$SearchRequest$Builder: org.waveprotocol.box.search.SearchProto$SearchRequest$Builder setQuery(java.lang.String)>($r2);

        $i0 = staticinvoke <java.lang.Integer: int parseInt(java.lang.String)>($r3);

        $r8 = virtualinvoke $r7.<org.waveprotocol.box.search.SearchProto$SearchRequest$Builder: org.waveprotocol.box.search.SearchProto$SearchRequest$Builder setIndex(int)>($i0);

        $i1 = staticinvoke <java.lang.Integer: int parseInt(java.lang.String)>($r5);

        $r9 = virtualinvoke $r8.<org.waveprotocol.box.search.SearchProto$SearchRequest$Builder: org.waveprotocol.box.search.SearchProto$SearchRequest$Builder setNumResults(int)>($i1);

        $r10 = virtualinvoke $r9.<org.waveprotocol.box.search.SearchProto$SearchRequest$Builder: org.waveprotocol.box.search.SearchProto$SearchRequest build()>();

        return $r10;
    }

    protected com.google.wave.api.SearchResult performSearch(org.waveprotocol.box.search.SearchProto$SearchRequest, org.waveprotocol.wave.model.wave.ParticipantId)
    {
        com.google.wave.api.data.converter.EventDataConverterManager $r8;
        org.waveprotocol.box.server.waveserver.WaveletProvider $r9;
        com.google.wave.api.JsonRpcResponse r31;
        org.waveprotocol.wave.model.wave.ParticipantId r27;
        java.lang.Integer $r3, $r4;
        org.waveprotocol.box.search.SearchProto$SearchRequest r1;
        java.util.Map $r29, $r32;
        org.waveprotocol.wave.util.logging.Log $r13;
        org.waveprotocol.box.server.rpc.AbstractSearchServlet r6;
        org.waveprotocol.box.server.robots.OperationServiceRegistry $r28;
        com.google.wave.api.JsonRpcConstant$ParamsProperty $r33;
        java.util.List $r23;
        com.google.wave.api.ProtocolVersion $r7;
        java.lang.StringBuilder $r12, $r14, $r16, $r17, $r18, $r19, $r20, $r21;
        com.google.wave.api.OperationRequest r25;
        com.google.wave.api.data.converter.EventDataConverter $r10;
        int $i0, $i1, $i2, $i3, $i4, $i5;
        java.lang.String $r2, $r15, $r22, $r26;
        org.waveprotocol.box.server.robots.util.ConversationUtil $r11;
        com.google.wave.api.SearchResult r35;
        org.waveprotocol.box.server.robots.OperationContextImpl $r5;
        com.google.wave.api.OperationQueue $r0;
        java.lang.Object $r24, $r30, $r34;

        r6 := @this: org.waveprotocol.box.server.rpc.AbstractSearchServlet;

        r1 := @parameter0: org.waveprotocol.box.search.SearchProto$SearchRequest;

        r27 := @parameter1: org.waveprotocol.wave.model.wave.ParticipantId;

        $r0 = new com.google.wave.api.OperationQueue;

        specialinvoke $r0.<com.google.wave.api.OperationQueue: void <init>()>();

        $r2 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: java.lang.String getQuery()>();

        $i0 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: int getIndex()>();

        $r3 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i0);

        $i1 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: int getNumResults()>();

        $r4 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i1);

        virtualinvoke $r0.<com.google.wave.api.OperationQueue: void search(java.lang.String,java.lang.Integer,java.lang.Integer)>($r2, $r3, $r4);

        $r5 = new org.waveprotocol.box.server.robots.OperationContextImpl;

        $r9 = r6.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.waveserver.WaveletProvider waveletProvider>;

        $r8 = r6.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: com.google.wave.api.data.converter.EventDataConverterManager converterManager>;

        $r7 = <com.google.wave.api.ProtocolVersion: com.google.wave.api.ProtocolVersion DEFAULT>;

        $r10 = virtualinvoke $r8.<com.google.wave.api.data.converter.EventDataConverterManager: com.google.wave.api.data.converter.EventDataConverter getEventDataConverter(com.google.wave.api.ProtocolVersion)>($r7);

        $r11 = r6.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.robots.util.ConversationUtil conversationUtil>;

        specialinvoke $r5.<org.waveprotocol.box.server.robots.OperationContextImpl: void <init>(org.waveprotocol.box.server.waveserver.WaveletProvider,com.google.wave.api.data.converter.EventDataConverter,org.waveprotocol.box.server.robots.util.ConversationUtil)>($r9, $r10, $r11);

        $r13 = <org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.wave.util.logging.Log LOG>;

        $r12 = new java.lang.StringBuilder;

        specialinvoke $r12.<java.lang.StringBuilder: void <init>()>();

        $r14 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>("Performing query: ");

        $r15 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: java.lang.String getQuery()>();

        $r16 = virtualinvoke $r14.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>($r15);

        $r17 = virtualinvoke $r16.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(" [");

        $i2 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: int getIndex()>();

        $r18 = virtualinvoke $r17.<java.lang.StringBuilder: java.lang.StringBuilder append(int)>($i2);

        $r19 = virtualinvoke $r18.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(", ");

        $i3 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: int getIndex()>();

        $i4 = virtualinvoke r1.<org.waveprotocol.box.search.SearchProto$SearchRequest: int getNumResults()>();

        $i5 = $i3 + $i4;

        $r20 = virtualinvoke $r19.<java.lang.StringBuilder: java.lang.StringBuilder append(int)>($i5);

        $r21 = virtualinvoke $r20.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>("]");

        $r22 = virtualinvoke $r21.<java.lang.StringBuilder: java.lang.String toString()>();

        virtualinvoke $r13.<org.waveprotocol.wave.util.logging.Log: void fine(java.lang.String)>($r22);

        $r23 = virtualinvoke $r0.<com.google.wave.api.OperationQueue: java.util.List getPendingOperations()>();

        $r24 = interfaceinvoke $r23.<java.util.List: java.lang.Object get(int)>(0);

        r25 = (com.google.wave.api.OperationRequest) $r24;

        $r26 = virtualinvoke r25.<com.google.wave.api.OperationRequest: java.lang.String getId()>();

        $r28 = r6.<org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.box.server.robots.OperationServiceRegistry operationRegistry>;

        staticinvoke <org.waveprotocol.box.server.robots.util.OperationUtil: void executeOperation(com.google.wave.api.OperationRequest,org.waveprotocol.box.server.robots.OperationServiceRegistry,org.waveprotocol.box.server.robots.OperationContext,org.waveprotocol.wave.model.wave.ParticipantId)>(r25, $r28, $r5, r27);

        $r29 = virtualinvoke $r5.<org.waveprotocol.box.server.robots.OperationContextImpl: java.util.Map getResponses()>();

        $r30 = interfaceinvoke $r29.<java.util.Map: java.lang.Object get(java.lang.Object)>($r26);

        r31 = (com.google.wave.api.JsonRpcResponse) $r30;

        $r32 = virtualinvoke r31.<com.google.wave.api.JsonRpcResponse: java.util.Map getData()>();

        $r33 = <com.google.wave.api.JsonRpcConstant$ParamsProperty: com.google.wave.api.JsonRpcConstant$ParamsProperty SEARCH_RESULTS>;

        $r34 = interfaceinvoke $r32.<java.util.Map: java.lang.Object get(java.lang.Object)>($r33);

        r35 = (com.google.wave.api.SearchResult) $r34;

        return r35;
    }

    static void <clinit>()
    {
        org.waveprotocol.wave.util.logging.Log $r0;

        $r0 = staticinvoke <org.waveprotocol.wave.util.logging.Log: org.waveprotocol.wave.util.logging.Log get(java.lang.Class)>(class "Lorg/waveprotocol/box/server/rpc/AbstractSearchServlet;");

        <org.waveprotocol.box.server.rpc.AbstractSearchServlet: org.waveprotocol.wave.util.logging.Log LOG> = $r0;

        <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String DEFAULT_QUERY> = "";

        <org.waveprotocol.box.server.rpc.AbstractSearchServlet: java.lang.String DEFAULT_NUMRESULTS> = "100";

        return;
    }
}
