public class org.mortbay.jetty.security.ClientCertAuthenticator extends java.lang.Object implements org.mortbay.jetty.security.Authenticator
{
    private int _maxHandShakeSeconds;

    public void <init>()
    {
        org.mortbay.jetty.security.ClientCertAuthenticator r0;

        r0 := @this: org.mortbay.jetty.security.ClientCertAuthenticator;

        specialinvoke r0.<java.lang.Object: void <init>()>();

        r0.<org.mortbay.jetty.security.ClientCertAuthenticator: int _maxHandShakeSeconds> = 60;

        return;
    }

    public int getMaxHandShakeSeconds()
    {
        int $i0;
        org.mortbay.jetty.security.ClientCertAuthenticator r0;

        r0 := @this: org.mortbay.jetty.security.ClientCertAuthenticator;

        $i0 = r0.<org.mortbay.jetty.security.ClientCertAuthenticator: int _maxHandShakeSeconds>;

        return $i0;
    }

    public void setMaxHandShakeSeconds(int)
    {
        int i0;
        org.mortbay.jetty.security.ClientCertAuthenticator r0;

        r0 := @this: org.mortbay.jetty.security.ClientCertAuthenticator;

        i0 := @parameter0: int;

        r0.<org.mortbay.jetty.security.ClientCertAuthenticator: int _maxHandShakeSeconds> = i0;

        return;
    }

    public java.security.Principal authenticate(org.mortbay.jetty.security.UserRealm, java.lang.String, org.mortbay.jetty.Request, org.mortbay.jetty.Response) throws java.io.IOException
    {
        java.security.cert.X509Certificate $r5, $r6, $r10;
        org.mortbay.jetty.Request r0;
        int $i0;
        org.mortbay.jetty.security.ClientCertAuthenticator r11;
        java.lang.String r12, $r14;
        org.mortbay.jetty.security.UserRealm r8;
        org.mortbay.jetty.Response r4;
        java.security.Principal $r7, $r9, r13;
        java.lang.Object $r1;
        java.security.cert.X509Certificate[] $r2, r3;

        r11 := @this: org.mortbay.jetty.security.ClientCertAuthenticator;

        r8 := @parameter0: org.mortbay.jetty.security.UserRealm;

        r12 := @parameter1: java.lang.String;

        r0 := @parameter2: org.mortbay.jetty.Request;

        r4 := @parameter3: org.mortbay.jetty.Response;

        $r1 = virtualinvoke r0.<org.mortbay.jetty.Request: java.lang.Object getAttribute(java.lang.String)>("javax.servlet.request.X509Certificate");

        $r2 = (java.security.cert.X509Certificate[]) $r1;

        r3 = (java.security.cert.X509Certificate[]) $r2;

        if r3 == null goto label1;

        $i0 = lengthof r3;

        if $i0 == 0 goto label1;

        $r5 = r3[0];

        if $r5 != null goto label3;

     label1:
        if r4 == null goto label2;

        virtualinvoke r4.<org.mortbay.jetty.Response: void sendError(int,java.lang.String)>(403, "A client certificate is required for accessing this web application but the server\'s listener is not configured for mutual authentication (or the client did not provide a certificate).");

     label2:
        return null;

     label3:
        $r6 = r3[0];

        $r7 = virtualinvoke $r6.<java.security.cert.X509Certificate: java.security.Principal getSubjectDN()>();

        r13 = $r7;

        if $r7 != null goto label4;

        $r10 = r3[0];

        r13 = virtualinvoke $r10.<java.security.cert.X509Certificate: java.security.Principal getIssuerDN()>();

     label4:
        if r13 != null goto label5;

        $r14 = "clientcert";

        goto label6;

     label5:
        $r14 = interfaceinvoke r13.<java.security.Principal: java.lang.String getName()>();

     label6:
        $r9 = interfaceinvoke r8.<org.mortbay.jetty.security.UserRealm: java.security.Principal authenticate(java.lang.String,java.lang.Object,org.mortbay.jetty.Request)>($r14, r3, r0);

        if $r9 != null goto label8;

        if r4 == null goto label7;

        virtualinvoke r4.<org.mortbay.jetty.Response: void sendError(int,java.lang.String)>(403, "The provided client certificate does not correspond to a trusted user.");

     label7:
        return null;

     label8:
        virtualinvoke r0.<org.mortbay.jetty.Request: void setAuthType(java.lang.String)>("CLIENT_CERT");

        virtualinvoke r0.<org.mortbay.jetty.Request: void setUserPrincipal(java.security.Principal)>($r9);

        return $r9;
    }

    public java.lang.String getAuthMethod()
    {
        org.mortbay.jetty.security.ClientCertAuthenticator r0;

        r0 := @this: org.mortbay.jetty.security.ClientCertAuthenticator;

        return "CLIENT_CERT";
    }
}
